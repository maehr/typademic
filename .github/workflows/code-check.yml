name: code-check
on: [push]

jobs:
    code-check:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - uses: actions/setup-python@v2
              with:
                  python-version: 3.9
            - uses: abatilo/actions-poetry@v2.0.0
              with:
                  poetry-version: 1.1.8
            - uses: actions/cache@v2
              with:
                  path: .venv
                  key: venv-${{ runner.os }}-${{ steps.full-python-version.outputs.version }}-${{ hashFiles('**/poetry.lock') }}
            - run: poetry install
            - name: black
              run: poetry run black . --check
            - name: isort
              run: poetry run isort . --check-only --profile black
            - name: flake8
              run: poetry run flake8 .
            - name: bandit
              run: poetry run bandit .
            - name: safety
              run: poetry run safety check
